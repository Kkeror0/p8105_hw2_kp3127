---
title: "p8105_hw2_kp3127"
output: html_document
date: "2025-09-25"
---

```{r setup}
library(tidyverse)
```

## Promblem 1
data in pols-month.csv
```{r}
pols_df=read.csv("./fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(
    col = mon, 
    into = c("year", "month", "day"), 
    sep = "-", 
  ) %>% 
    mutate(
      year  = as.character(year),
      month = as.integer(month),       
      month = month.name[month],       
      month = as.character(month),
      president = case_when(prez_gop == 1 ~ "gop",prez_dem == 1 ~ "dem")
  ) %>% 
  select(-day, -prez_gop, -prez_dem)
```

data in snp.csv
```{r}
snp_df=read.csv("./fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
    separate(
    col = date, 
    into = c("day", "month", "year"), 
    sep = "/", 
  ) %>% 
  mutate(
    month=month.name[as.integer(month)],
    year=as.integer(year),
    year  = ifelse(year < 50, 2000 + year, 1900 + year),
    year=as.character(year),
    month=as.character(month)) %>% 
  arrange(year,month) %>% 
  select(-day) %>% 
  select(year,month,everything())
```
data in unemployment .csv
```{r}
unemp_df=read.csv("./fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = 'month',
    values_to = "unemployment"
  ) %>% 
  mutate(
    month = month.name[match(tolower(month), tolower(month.abb))],
    year=as.character(year),
    month=as.character(month)
  )
```
joining datasets
```{r}

pols_snp = left_join(pols_df, snp_df, by = c("year", "month"))

final_df = left_join(pols_snp, unemp_df, by = c("year", "month"))
```

The `pols-month` dataset contains information on the number of national politicians (governors, senators, representatives) who were Republican or Democrat, and a variable indicating which party held the presidency in a given month.  

The `snp` dataset reports the closing value of the S&P stock index for each month.  

The `unemployment` dataset shows the percentage of unemployment, by month and year.  

After cleaning and merging by `year` and `month`, the resulting dataset has `r dim(final_df)[1]` rows and `r dim(final_df)[2]` columns, spanning years `r range(final_df$year, na.rm = TRUE)[1]` to `r range(final_df$year, na.rm = TRUE)[2]`. Key variables include `year`, `month`, `president` (party in power), `close` (S&P closing value), and `unemployment` (unemployment rate).  

#Problem 2
Data in Mr. Trash Wheel sheet:
```{r}
mr_trash_df=readxl::read_excel("./fivethirtyeight_datasets/202409 Trash Wheel Collection Data.xlsx",
                            sheet = "Mr. Trash Wheel",
                            skip=1,
                            range="A2:N655"
                            ) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(
    sports_balls=as.integer(round(sports_balls)),
    wheel="mr",
    year=as.character(year)
  ) %>% 
  select(wheel,everything())
```
Data in Professor Trash Wheel:
```{r}
pro_trash_df=readxl::read_excel("./fivethirtyeight_datasets/202409 Trash Wheel Collection Data.xlsx",
                            sheet = "Professor Trash Wheel",
                            skip=1,
                            range="A2:M123"
                            ) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(
    wheel="pro",
    year=as.character(year)
  ) %>% 
  select(wheel,everything())
```

Data in Gwynnda Trash Wheel:
```{r}
gwy_trash_df=readxl::read_excel("./fivethirtyeight_datasets/202409 Trash Wheel Collection Data.xlsx",
                            sheet = "Gwynnda Trash Wheel",
                            skip=1,
                            range="A2:L266"
                            ) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(
    wheel="gwy",
    year=as.character(year)
  ) %>% 
  select(wheel,everything())
```

Combine:
```{r}
trash_df=bind_rows(mr_trash_df,pro_trash_df,gwy_trash_df)
```
The combined Trash Wheel dataset contains `r nrow(trash_df)` observations, each corresponding to a dumpster of trash collected by one of the wheels (Mr., Professor, or Gwynnda). Key variables include `dumpster` (the dumpster identifier), `date`, `weight_tons` (weight of trash in tons), `volume_cubic_yards`, and counts of items such as `plastic_bottles`, `polystyrene`, `cigarette_butts`, and `sports_balls`.  
For available data, Professor Trash Wheel has collected a total of `r trash_df %>% filter(wheel == "pro") %>% summarise(sum(weight_tons, na.rm = TRUE)) %>% pull()` tons of trash. Gwynnda collected `r format(trash_df %>% filter(wheel == "gwy", lubridate::year(date) == 2022, lubridate::month(date) == 6) %>% summarise(sum(cigarette_butts, na.rm = TRUE)) %>% pull(),scientific = FALSE)` cigarette butts in June 2022.

`r format(trash_df %>% 
             filter(wheel == "gwy", 
                    lubridate::year(date) == 2022, 
                    lubridate::month(date) == 6) %>% 
             summarise(sum(cigarette_butts, na.rm = TRUE)) %>% 
             pull(), scientific = FALSE)`

